export const MULTI_TAB_KEY = 'multitab';
export const SESSION_KEY = 'session';
export const TERMS_KEY = 'terms';
export const SES_VALUE_TRUE = 'T';
export const SES_VALUE_FALSE = 'F';
export class AuthUtil {
    static copyFromSessionStorageToLocalStorage(keys) {
        keys.forEach((key) => {
            const value = sessionStorage.getItem(key);
            if (value !== null) {
                localStorage.setItem(key, value);
            }
        });
    }
    static setMultiTabSession(multiTabSession) {
        if (multiTabSession) {
            if (localStorage.getItem(MULTI_TAB_KEY) !== SES_VALUE_TRUE) {
                localStorage.setItem(MULTI_TAB_KEY, SES_VALUE_TRUE);
                this.copyFromSessionStorageToLocalStorage([SESSION_KEY, TERMS_KEY]);
            }
        }
        else {
            localStorage.setItem(MULTI_TAB_KEY, SES_VALUE_FALSE);
            localStorage.removeItem(SESSION_KEY);
            localStorage.removeItem(TERMS_KEY);
        }
    }
    static isMultiTabSession() {
        return localStorage.getItem(MULTI_TAB_KEY) === SES_VALUE_TRUE;
    }
    static clearSessionStorage() {
        if (AuthUtil.isMultiTabSession()) {
            localStorage.removeItem(SESSION_KEY);
            localStorage.removeItem(TERMS_KEY);
        }
        sessionStorage.clear();
    }
    static getJWTFromSession() {
        const loginResult = AuthUtil.getLoginResult();
        return loginResult ? loginResult.token : null;
    }
    static getSessionInfo() {
        const loginResult = AuthUtil.getLoginResult();
        return loginResult ? loginResult.session : null;
    }
    static updateSessionInfo(session) {
        const loginResult = AuthUtil.getLoginResult();
        loginResult.session = session;
        if (AuthUtil.isMultiTabSession()) {
            localStorage.setItem(SESSION_KEY, JSON.stringify(loginResult));
        }
        else {
            sessionStorage.setItem(SESSION_KEY, JSON.stringify(loginResult));
        }
    }
    static getLoginResult() {
        const sessionData = AuthUtil.isMultiTabSession()
            ? localStorage.getItem(SESSION_KEY)
            : sessionStorage.getItem(SESSION_KEY);
        return sessionData ? JSON.parse(sessionData) : null;
    }
    static setLoginResult(loginResult) {
        if (AuthUtil.isMultiTabSession()) {
            localStorage.setItem(SESSION_KEY, JSON.stringify(loginResult));
        }
        else {
            sessionStorage.setItem(SESSION_KEY, JSON.stringify(loginResult));
        }
    }
    static isLoggedIn() {
        return this.getLoginResult() != null;
    }
    static isTermsAccepted() {
        const termsOfUse = JSON.parse(AuthUtil.isMultiTabSession() ? localStorage.getItem(TERMS_KEY) : sessionStorage.getItem(TERMS_KEY));
        return termsOfUse && (termsOfUse.code === 'Y' || termsOfUse.code === SES_VALUE_TRUE);
    }
    static setTermsAccepted(accept) {
        const terms = {
            code: accept ? SES_VALUE_TRUE : SES_VALUE_FALSE,
            key_value: null,
            display_text: null,
        };
        const termsString = JSON.stringify(terms);
        if (AuthUtil.isMultiTabSession()) {
            localStorage.setItem(TERMS_KEY, termsString);
        }
        else {
            sessionStorage.setItem(TERMS_KEY, termsString);
        }
    }
    static getRoleCode() {
        const loginResult = AuthUtil.getLoginResult();
        return loginResult ? loginResult.session.roleCode : null;
    }
    static getRoleId() {
        const loginResult = AuthUtil.getLoginResult();
        return loginResult ? loginResult.session.roleId : null;
    }
    static getRoleName() {
        const loginResult = AuthUtil.getLoginResult();
        return loginResult ? loginResult.session.roleName : null;
    }
    static getOrgId() {
        const loginResult = AuthUtil.getLoginResult();
        return loginResult ? loginResult.session.orgId : null;
    }
    static getOrgName() {
        const loginResult = AuthUtil.getLoginResult();
        return loginResult ? loginResult.session.orgName : null;
    }
    static getLanguage() {
        const loginResult = AuthUtil.getLoginResult();
        return loginResult ? loginResult.session.language : null;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aC51dGlsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXMyLWNvbW1vbnMvc3JjL2xpYi9hdXRoL2F1dGgudXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxNQUFNLENBQUMsTUFBTSxhQUFhLEdBQUcsVUFBVSxDQUFDO0FBQ3hDLE1BQU0sQ0FBQyxNQUFNLFdBQVcsR0FBRyxTQUFTLENBQUM7QUFDckMsTUFBTSxDQUFDLE1BQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQztBQUVqQyxNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsR0FBRyxDQUFDO0FBQ2xDLE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBRyxHQUFHLENBQUM7QUFFbkMsTUFBTSxPQUFPLFFBQVE7SUFDWCxNQUFNLENBQUMsb0NBQW9DLENBQUMsSUFBYztRQUNoRSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUU7WUFDbkIsTUFBTSxLQUFLLEdBQUcsY0FBYyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUMxQyxJQUFJLEtBQUssS0FBSyxJQUFJLEVBQUU7Z0JBQ2xCLFlBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO2FBQ2xDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRU0sTUFBTSxDQUFDLGtCQUFrQixDQUFDLGVBQXdCO1FBQ3ZELElBQUksZUFBZSxFQUFFO1lBQ25CLElBQUksWUFBWSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsS0FBSyxjQUFjLEVBQUU7Z0JBQzFELFlBQVksQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLGNBQWMsQ0FBQyxDQUFDO2dCQUNwRCxJQUFJLENBQUMsb0NBQW9DLENBQUMsQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQzthQUNyRTtTQUNGO2FBQU07WUFDTCxZQUFZLENBQUMsT0FBTyxDQUFDLGFB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QVcsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDM0QsQ0FBQztJQUVNLE1BQU0sQ0FBQyxRQUFRO1FBQ3BCLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUM5QyxPQUFPLFdBQVcsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUN4RCxDQUFDO0lBRU0sTUFBTSxDQUFDLFVBQVU7UUFDdEIsTUFBTSxXQUFXLEdBQUcsUUFBUSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQzlDLE9BQU8sV0FBVyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQzFELENBQUM7SUFFTSxNQUFNLENBQUMsV0FBVztRQUN2QixNQUFNLFdBQVcsR0FBRyxRQUFRLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDOUMsT0FBTyxXQUFXLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDM0QsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU3ByX2tleV92YWx1ZXNfb3QgfSBmcm9tICcuLi9tb2RlbC9zcHJfa2V5X3ZhbHVlc19vdCc7XHJcbmltcG9ydCB7IExvZ2luUmVzdWx0LCBXZWJTZXNzaW9uSW5mbyB9IGZyb20gJy4uL21vZGVsL2NvbW1vbi5hcGknO1xyXG5cclxuZXhwb3J0IGNvbnN0IE1VTFRJX1RBQl9LRVkgPSAnbXVsdGl0YWInO1xyXG5leHBvcnQgY29uc3QgU0VTU0lPTl9LRVkgPSAnc2Vzc2lvbic7XHJcbmV4cG9ydCBjb25zdCBURVJNU19LRVkgPSAndGVybXMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IFNFU19WQUxVRV9UUlVFID0gJ1QnO1xyXG5leHBvcnQgY29uc3QgU0VTX1ZBTFVFX0ZBTFNFID0gJ0YnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEF1dGhVdGlsIHtcclxuICBwcml2YXRlIHN0YXRpYyBjb3B5RnJvbVNlc3Npb25TdG9yYWdlVG9Mb2NhbFN0b3JhZ2Uoa2V5czogc3RyaW5nW10pOiB2b2lkIHtcclxuICAgIGtleXMuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xyXG4gICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIHNldE11bHRpVGFiU2Vzc2lvbihtdWx0aVRhYlNlc3Npb246IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgIGlmIChtdWx0aVRhYlNlc3Npb24pIHtcclxuICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKE1VTFRJX1RBQl9LRVkpICE9PSBTRVNfVkFMVUVfVFJVRSkge1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKE1VTFRJX1RBQl9LRVksIFNFU19WQUxVRV9UUlVFKTtcclxuICAgICAgICB0aGlzLmNvcHlGcm9tU2Vzc2lvblN0b3JhZ2VUb0xvY2FsU3RvcmFnZShbU0VTU0lPTl9LRVksIFRFUk1TX0tFWV0pO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShNVUxUSV9UQUJfS0VZLCBTRVNfVkFMVUVfRkFMU0UpO1xyXG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShTRVNTSU9OX0tFWSk7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFRFUk1TX0tFWSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGlzTXVsdGlUYWJTZXNzaW9uKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKE1VTFRJX1RBQl9LRVkpID09PSBTRVNfVkFMVUVfVFJVRTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgY2xlYXJTZXNzaW9uU3RvcmFnZSgpOiB2b2lkIHtcclxuICAgIGlmIChBdXRoVXRpbC5pc011bHRpVGFiU2Vzc2lvbigpKSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFNFU1NJT05fS0VZKTtcclxuICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oVEVSTVNfS0VZKTtcclxuICAgIH1cclxuICAgIHNlc3Npb25TdG9yYWdlLmNsZWFyKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGdldEpXVEZyb21TZXNzaW9uKCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBsb2dpblJlc3VsdCA9IEF1dGhVdGlsLmdldExvZ2luUmVzdWx0KCk7XHJcbiAgICByZXR1cm4gbG9naW5SZXN1bHQgPyBsb2dpblJlc3VsdC50b2tlbiA6IG51bGw7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGdldFNlc3Npb25JbmZvKCk6IFdlYlNlc3Npb25JbmZvIHtcclxuICAgIGNvbnN0IGxvZ2luUmVzdWx0ID0gQXV0aFV0aWwuZ2V0TG9naW5SZXN1bHQoKTtcclxuICAgIHJldHVybiBsb2dpblJlc3VsdCA/IGxvZ2luUmVzdWx0LnNlc3Npb24gOiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyB1cGRhdGVTZXNzaW9uSW5mbyhzZXNzaW9uOiBXZWJTZXNzaW9uSW5mbyk6IHZvaWQge1xyXG4gICAgY29uc3QgbG9naW5SZXN1bHQgPSBBdXRoVXRpbC5nZXRMb2dpblJlc3VsdCgpO1xyXG4gICAgbG9naW5SZXN1bHQuc2Vzc2lvbiA9IHNlc3Npb247XHJcbiAgICBpZiAoQXV0aFV0aWwuaXNNdWx0aVRhYlNlc3Npb24oKSkge1xyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShTRVNTSU9OX0tFWSwgSlNPTi5zdHJpbmdpZnkobG9naW5SZXN1bHQpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oU0VTU0lPTl9LRVksIEpTT04uc3RyaW5naWZ5KGxvZ2luUmVzdWx0KSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGdldExvZ2luUmVzdWx0KCk6IExvZ2luUmVzdWx0PFdlYlNlc3Npb25JbmZvPiB7XHJcbiAgICBjb25zdCBzZXNzaW9uRGF0YSA9IEF1dGhVdGlsLmlzTXVsdGlUYWJTZXNzaW9uKClcclxuICAgICAgPyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShTRVNTSU9OX0tFWSlcclxuICAgICAgOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFNFU1NJT05fS0VZKTtcclxuICAgIHJldHVybiBzZXNzaW9uRGF0YSA/IChKU09OLnBhcnNlKHNlc3Npb25EYXRhKSBhcyBMb2dpblJlc3VsdDxXZWJTZXNzaW9uSW5mbz4pIDogbnVsbDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgc2V0TG9naW5SZXN1bHQobG9naW5SZXN1bHQ6IExvZ2luUmVzdWx0PFdlYlNlc3Npb25JbmZvPik6IHZvaWQge1xyXG4gICAgaWYgKEF1dGhVdGlsLmlzTXVsdGlUYWJTZXNzaW9uKCkpIHtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oU0VTU0lPTl9LRVksIEpTT04uc3RyaW5naWZ5KGxvZ2luUmVzdWx0KSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFNFU1NJT05fS0VZLCBKU09OLnN0cmluZ2lmeShsb2dpblJlc3VsdCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBpc0xvZ2dlZEluKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0TG9naW5SZXN1bHQoKSAhPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBpc1Rlcm1zQWNjZXB0ZWQoKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCB0ZXJtc09mVXNlID0gSlNPTi5wYXJzZShcclxuICAgICAgQXV0aFV0aWwuaXNNdWx0aVRhYlNlc3Npb24oKSA/IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRFUk1TX0tFWSkgOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFRFUk1TX0tFWSlcclxuICAgICkgYXMgU3ByX2tleV92YWx1ZXNfb3Q7XHJcbiAgICByZXR1cm4gdGVybXNPZlVzZSAmJiAodGVybXNPZlVzZS5jb2RlID09PSAnWScgfHwgdGVybXNPZlVzZS5jb2RlID09PSBTRVNfVkFMVUVfVFJVRSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIHNldFRlcm1zQWNjZXB0ZWQoYWNjZXB0OiBib29sZWFuKTogdm9pZCB7XHJcbiAgICBjb25zdCB0ZXJtczogU3ByX2tleV92YWx1ZXNfb3QgPSB7XHJcbiAgICAgIGNvZGU6IGFjY2VwdCA/IFNFU19WQUxVRV9UUlVFIDogU0VTX1ZBTFVFX0ZBTFNFLFxyXG4gICAgICBrZXlfdmFsdWU6IG51bGwsXHJcbiAgICAgIGRpc3BsYXlfdGV4dDogbnVsbCxcclxuICAgIH07XHJcbiAgICBjb25zdCB0ZXJtc1N0cmluZyA9IEpTT04uc3RyaW5naWZ5KHRlcm1zKTtcclxuICAgIGlmIChBdXRoVXRpbC5pc011bHRpVGFiU2Vzc2lvbigpKSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRFUk1TX0tFWSwgdGVybXNTdHJpbmcpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShURVJNU19LRVksIHRlcm1zU3RyaW5nKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0Um9sZUNvZGUoKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGxvZ2luUmVzdWx0ID0gQXV0aFV0aWwuZ2V0TG9naW5SZXN1bHQoKTtcclxuICAgIHJldHVybiBsb2dpblJlc3VsdCA/IGxvZ2luUmVzdWx0LnNlc3Npb24ucm9sZUNvZGUgOiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBnZXRSb2xlSWQoKTogbnVtYmVyIHtcclxuICAgIGNvbnN0IGxvZ2luUmVzdWx0ID0gQXV0aFV0aWwuZ2V0TG9naW5SZXN1bHQoKTtcclxuICAgIHJldHVybiBsb2dpblJlc3VsdCA/IGxvZ2luUmVzdWx0LnNlc3Npb24ucm9sZUlkIDogbnVsbDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0Um9sZU5hbWUoKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGxvZ2luUmVzdWx0ID0gQXV0aFV0aWwuZ2V0TG9naW5SZXN1bHQoKTtcclxuICAgIHJldHVybiBsb2dpblJlc3VsdCA/IGxvZ2luUmVzdWx0LnNlc3Npb24ucm9sZU5hbWUgOiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBnZXRPcmdJZCgpOiBudW1iZXIge1xyXG4gICAgY29uc3QgbG9naW5SZXN1bHQgPSBBdXRoVXRpbC5nZXRMb2dpblJlc3VsdCgpO1xyXG4gICAgcmV0dXJuIGxvZ2luUmVzdWx0ID8gbG9naW5SZXN1bHQuc2Vzc2lvbi5vcmdJZCA6IG51bGw7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGdldE9yZ05hbWUoKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGxvZ2luUmVzdWx0ID0gQXV0aFV0aWwuZ2V0TG9naW5SZXN1bHQoKTtcclxuICAgIHJldHVybiBsb2dpblJlc3VsdCA/IGxvZ2luUmVzdWx0LnNlc3Npb24ub3JnTmFtZSA6IG51bGw7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGdldExhbmd1YWdlKCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBsb2dpblJlc3VsdCA9IEF1dGhVdGlsLmdldExvZ2luUmVzdWx0KCk7XHJcbiAgICByZXR1cm4gbG9naW5SZXN1bHQgPyBsb2dpblJlc3VsdC5zZXNzaW9uLmxhbmd1YWdlIDogbnVsbDtcclxuICB9XHJcbn1cclxuIl19